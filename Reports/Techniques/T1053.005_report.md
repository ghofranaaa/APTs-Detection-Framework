# Detection Report: T1053.005 – Scheduled Task (Startup / Logon)

**Technique:** Scheduled Task / Job – Scheduled Task

---

## 1. Technique Overview

**Technique ID:** T1033
**Technique Name:** Scheduled Task
**Tactic:** Execution  
**Platform:** Windows

**Description:**  
Adversaries abuse the Windows Task Scheduler to execute programs and commands on compromised systems. The Windows Task Scheduler is a legitimate component that allows automated execution of programs at specific times, during system startup, or when users log on. Attackers exploit this feature to execute malicious code without direct user interaction. By creating scheduled tasks, attackers can run payloads, scripts, or commands automatically based on predefined triggers such as user logon or system startup. This provides attackers with a reliable method to execute their malicious operations on target systems while appearing as legitimate scheduled maintenance or administrative tasks.

---

## 2. Attack Simulation

**Test Framework:** Atomic Red Team  
**Atomic Test Number:** Test #1  
**Execution Method:** Evil-WinRM from Kali Linux to Windows 10 VM

**Command Executed:**
```    "\"cmd.exe\" /c schtasks /create /tn \"T1053_005_OnLogon\" /sc onlogon /tr \"cmd.exe /c calc.exe\" & schtasks /create /tn \"T1053_005_OnStartup\" /sc onstart /ru system /tr \"cmd.exe /c calc.exe\""

```

**Command Breakdown:**
- `cmd.exe /c` - Executes commands and terminates
- `schtasks /create /tn "T1053_005_OnLogon"` - Creates first scheduled task named "T1053_005_OnLogon"
- `/sc onlogon` - Schedule trigger: run when any user logs on
- `/tr "cmd.exe /c calc.exe"` - Task action: execute calc.exe
- `&` - Command chaining operator to execute next command
- `schtasks /create /tn "T1053_005_OnStartup" - Creates second scheduled task named "T1053_005_OnStartup"
- `/sc onstart` - Schedule trigger: run at system startup
- `/ru system` - Run as SYSTEM account (elevated privileges)
- `/tr "cmd.exe /c calc.exe"` - Task action: execute calc.exe

**Why this is malicious:**  
While scheduled tasks are legitimate, creating tasks that execute arbitrary commands at logon or startup is a common persistence and execution mechanism used by attackers. This behavior is especially suspicious when performed via remote execution, with high integrity, and from temporary directories.
---

## 3. Detection Configuration

**SIEM Platform:** Elastic Stack (Elasticsearch + Kibana)  
**Data Source:** Sysmon Event ID 1 (Process Creation)  
**Collection Agent:** Winlogbeat  
**Event Channel:** Microsoft-Windows-Sysmon/Operational

**Kibana Detection Rule:**
```kql
winlog.channel: "Microsoft-Windows-Sysmon/Operational"
AND event.code: "1"
AND process.name: "schtasks.exe"
AND (process.command_line.text: "*onlogon*"
OR process.command_line.text: "*onstart*")
AND process.command_line.text: "*/create*"
```

**Detection Logic:**
- Monitors Sysmon Event ID 1 (Process Creation)
- Filters for schtasks.exe execution specifically
- Detects /create parameter indicating new scheduled task creation
- Identifies persistence triggers: onlogon (runs at user logon) or onstart (runs at system startup)

**Why this works:**  
Most legitimate scheduled tasks use time-based triggers (daily, weekly) rather than logon/startup triggers. Command-line creation of scheduled tasks is rare in normal user activity, as most users interact with Task Scheduler through the GUI. The combination of schtasks.exe with /create and persistence triggers (onlogon/onstart) is a strong indicator of malicious activity, particularly when executed remotely or by non-administrative users during unusual times.
---

## 4. Test Results

**Status:** ✅ Successfully Detected

**Alert Details:**
- **Alert Triggered:** Yes, in Kibana Security Alerts interface
- **Timestamp:** Jan 27, 2026 @ 21:47:54.537
- **Severity:** High
- **Host:** DESKTOP-K1Q1TJA

**Evidence Collected:**
- **Process Name:** schtasks.exe
- **Command Line:** ````    "\"cmd.exe\" /c schtasks /create /tn \"T1053_005_OnLogon\" /sc onlogon /tr \"cmd.exe /c calc.exe\" & schtasks /create /tn \"T1053_005_OnStartup\" /sc onstart /ru system /tr \"cmd.exe /c calc.exe\""`
- **Parent Process:** cmd.exe
- **User:** Administrator
- **integrity level:** High
- **Execution Context:** Local command execution
- **Working Directory:** `C:\Users\ADMINI~1\AppData\Local\Temp\`
- **Process ID:** 4876

**Observations:**
The scheduled task was created with an automatic execution trigger and high privileges, consistent with attacker execution behavior. The task configuration ensures repeated execution without further interaction.

---

## 5. Sigma Rule Effectiveness

**Rule Performance:** Effective  
**Alert Accuracy:** True Positive

**Strengths:**
- Successfully detected scheduled task creation with persistence triggers
- Full command-line visibility captured all parameters including task name and trigger
- Catches both user logon and system startup persistence variants

---

## 6. False Positive Analysis

**Potential False Positives:**

1. **Legitimate Administrative Task Scheduling**
   - System administrators creating scheduled maintenance tasks
   - IT staff configuring backup or monitoring tasks via command line

2. **Enterprise Software Creating Startup Tasks**
   - Software installers adding startup tasks during installation
   - Business applications configuring automatic update mechanisms

3. **IT Automation Scripts**
   - Configuration management tools (SCCM, Ansible, PowerShell DSC)
   - Deployment scripts creating scheduled tasks for system management

**Likelihood:** Low to Medium

**Mitigation Strategies:**
- Whitelist known administrative tools and software installers by hash
- Exclude approved IT automation accounts during maintenance windows
- Focus alerts on suspicious task names or executable paths (TEMP, AppData)
- Correlate with other indicators (remote execution, unusual timing)

---

## 7. Conclusion

This detection successfully identified the creation of scheduled tasks designed to execute commands at system startup or user logon. Such behavior is a well-known attacker technique for reliable execution. When observed in conjunction with remote execution and elevated privileges, it represents a high-confidence indicator of malicious activity consistent with T1053.005.

---

## References

- MITRE ATT&CK T1033: https://attack.mitre.org/techniques/T1053/005
- Atomic Red Team: https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053.005/T1053.005.md