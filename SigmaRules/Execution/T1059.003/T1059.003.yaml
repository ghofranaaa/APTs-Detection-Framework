title: Suspicious CMD File Operations in TEMP Directory via Remote Execution
id: a7b3c8d9-4e5f-6a7b-8c9d-0e1f2a3b4c5d
status: experimental
description: Detects cmd.exe writing and reading files in TEMP directory via remote execution
references:
    - https://attack.mitre.org/techniques/T1059/003/
    - https://github.com/redcanaryco/atomic-red-team
author: Ghofrane Amemi
date: 2026-01-22
tags:
  - attack.execution
  - attack.t1059
  - attack.t1059.003
  - atomic_red_team

logsource:
  product: windows
  category: process_creation
  service: sysmon

detection:
  selection_cmd:
    Image|endswith: '\cmd.exe'
    CommandLine|contains:
      - 'echo'
      - 'type'
  selection_parent:
    ParentImage|endswith: '\wsmprovhost.exe'  


  condition: selection_cmd and selection_parent

falsepositives:
  - Legitimate remote administration scripts
  - Automated deployment tools

level: high
