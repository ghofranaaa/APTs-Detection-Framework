# T1033 – System Owner/User Discovery

## Technique Description

**MITRE ATT&CK ID:** T1053.005
**Tactic:** Execution 
**Platform:** Windows

Adversaries use Scheduled Tasks to execute malicious code automatically at system startup or user logon. This technique allows attackers to ensure code execution without user interaction and can is used for initial execution.

On Windows systems, adversaries frequently abuse the native utility schtasks.exe to create scheduled tasks. Because schtasks is a legitimate administrative tool, malicious usage can blend in with normal system management activity, especially when executed with high privileges.

Startup (/sc onstart) and logon (/sc onlogon) triggers are particularly attractive because they guarantee execution during predictable system events.

**Real-World Usage:**  
The theat actors **APT28** have been observed using scheduled tasks to maintain persistence and trigger execution of payloads after system reboot or user authentication.

---

## Atomic Red Team Test

**Test Number:** Test #1  
**Supported Platforms:** Windows

### Test Command
```
schtasks /create /tn "T1053_005_OnLogon" /sc onlogon /tr "cmd.exe /c calc.exe"
schtasks /create /tn "T1053_005_OnStartup" /sc onstart /ru system /tr "cmd.exe /c calc.exe"
```

**Parameters:**
- `/create` - Creates a new scheduled task

- `/tn` - Task name

- `/sc onlogon` - Executes when a user logs on

- `/sc onstart` - Executes at system startup

- `/tr` - Command or program to execut

- `/ru system` - Executes task as SYSTEM

### Expected Behavior
When executed, these commands register scheduled tasks that automatically run commands during logon or system startup. This ensures repeated execution of attacker-controlled commands and provides a reliable mechanism for execution across reboots.

---

## Sigma Rule

```yaml
title: Scheduled Task Creation via schtasks for Persistence or Execution
id: b9a3c7f4-t1053-005-scheduled-task
status: experimental
description: Detects creation of scheduled tasks configured to execute at system startup or user logon using schtasks.exe, consistent with T1053.005 Scheduled Task.
references:
    - https://attack.mitre.org/techniques/T1053/005/
    - https://github.com/redcanaryco/atomic-red-team
author: Ghofrane Amemi
date: 2026-01-27
tags:
  - attack.execution
  - attack.t1053
  - attack.t1059.005
  - atomic_red_team

logsource:
  product: windows
  category: process_creation
  service: sysmon

detection:
  selection_schtasks:
    Image|endswith: '\schtasks.exe'
    CommandLine|contains:
      - 'create'
    CommandLine|contains|any:
      - '/sc onlogon'
      - '/sc onstart'
  selection_parent:
    ParentImage|endswith: '\cmd.exe'  


  condition: selection_schtasks and selection_parent

falsepositives:
  - Legitimate administrative task scheduling
  - Enterprise software creating startup tasks
  - IT automation scripts

level: high
```
---

## Kibana Detection Query

**Rule Name:** T1053.005 – Suspicious Scheduled Task Creation (Startup or Logon)
**Severity:** High

### KQL Query
```kql
winlog.channel: "Microsoft-Windows-Sysmon/Operational"
AND event.code: "1"
AND process.name: "schtasks.exe"
AND (process.command_line.text: "*onlogon*"
OR process.command_line.text: "*onstart*")
AND process.command_line.text: "*/create*"
```

### Required Data Sources
- **Log Source:** Sysmon
- **Event ID:** 1 (Process Creation)
- **Channel:** Microsoft-Windows-Sysmon/Operational

---

## Limitations

This detection does not cover:
- Scheduled task creation via PowerShell (Register-ScheduledTask)
- Task creation via COM interfaces or Task Scheduler APIs
- Legitimate scheduled tasks without additional context