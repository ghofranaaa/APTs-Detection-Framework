# T1016.002 - System Network Configuration Discovery: Wi-Fi Discovery

## Technique Description

**MITRE ATT&CK ID:** T1016.002  
**Tactic:** Discovery  
**Platform:** Windows

Adversaries use native Windows commands to discover wireless network configurations, saved Wi-Fi profiles, and passwords. By enumerating Wi-Fi profiles, attackers can gather information about available wireless networks, previously connected networks, and extract plaintext passwords for saved networks. This provides intelligence about the victim's network environment, potential lateral movement targets, and credentials that can be used for persistence or accessing other networks the victim uses (home, office, public Wi-Fi).

**Real-World Usage:**  
This technique has been used by **APT28** (Fancy Bear) for network reconnaissance to map victim environments and steal Wi-Fi credentials for lateral movement and persistence across multiple networks.

---

## Atomic Red Team Test

**Test Number:** Test #1  
**Supported Platforms:** Windows

### Test Command
```cmd
netsh wlan show profile #{SSID} key=clear
```

**Parameters:**
- `#{SSID}` - The Wi-Fi network name to enumerate (use `*` for all profiles)
- `key=clear` - Parameter to display passwords in plaintext

### Expected Behavior
When executed, this command enumerates saved Wi-Fi profiles on the system and extracts their plaintext passwords using the `key=clear` parameter. Attackers use this to steal Wi-Fi credentials, map the victim's network connections, and identify potential lateral movement opportunities. The extracted passwords provide access to networks the victim has previously connected to, enabling attackers to maintain persistence or pivot to other targets on those networks.

---

## Sigma Rule

```yaml
title: Wi-Fi Password Extraction via Netsh
id: f8c4d5e6-wifi-netsh-1016-002
status: experimental
description: >
  Detects extraction of Wi-Fi passwords using netsh command with key=clear parameter,
  indicating reconnaissance via System Network Configuration Discovery (T1016.002).
references:
  - https://attack.mitre.org/techniques/T1016/002/
  - https://github.com/redcanaryco/atomic-red-team
author: Ghofrane Amemi
date: 2026-01-25
tags:
  - attack.discovery
  - attack.t1016
  - attack.t1016.002
  - atomic_red_team

logsource:
  product: windows
  category: process_creation
  service: sysmon

detection:
  selection_netsh:
    Image|endswith: '\netsh.exe'
    CommandLine|contains|all:
      - 'wlan'
      - 'show'
      - 'profile'
      - 'key=clear'
  selection_parent:
    ParentImage|endswith: '\cmd.exe'

  condition: selection_netsh and selection_parent

falsepositives:
  - Rare legitimate IT troubleshooting activities
  - Network diagnostic scripts

level: high
```

---

## Kibana Detection Query

**Rule Name:** T1016.002 - Wi-Fi Password Extraction via Netsh  
**Severity:** High

### KQL Query
```kql
winlog.channel: "Microsoft-Windows-Sysmon/Operational"
AND event.code: "1"
AND process.name: "netsh.exe"
AND process.command_line.text: (*wlan* AND *show* AND *profile* AND *key=clear*)
```

---

### Required Data Sources
- **Log Source:** Sysmon
- **Event ID:** 1 (Process Creation)
- **Channel:** Microsoft-Windows-Sysmon/Operational

---

## Limitations

This detection rule focuses on netsh.exe commands that explicitly use the `key=clear` parameter to extract Wi-Fi passwords. It will not detect:
- Wi-Fi profile enumeration without password extraction (netsh wlan show profiles without key=clear)
- Direct registry access to retrieve Wi-Fi credentials
- PowerShell-based equivalents for Wi-Fi enumeration
- GUI-based Wi-Fi password viewing
- Obfuscated netsh commands

The rule is optimized for detecting the most common and dangerous variant of this technique where attackers extract plaintext passwords.